%%
%beta=0.88, lamba = 1:0.25:4.5, c=1, Wm=Wl=0.5,  epsilon_ref = 0, k=1.109; N = 10000;
opt_eps_max1=[0.0122,0.0113,0.0106,0.0101,0.0096,0.0092 0.0089,0.0086,0.0083,0.0081,0.0079,0.0077,0.0075,0.0074,0.0072];
opt_Uc1=[0.971683850983150,0.971608832051508,0.971537958583667,0.971470318464849,0.971405314014735,0.971342488364834,0.971281524793845,0.971222176525375,0.971164231453492,0.971107557933493,0.971051994247962,0.970997446837045,0.970943804979201,0.970890999988639,0.970838997788378]
Uc_byEUT = [0.971674918950025,0.971585715406831,0.971495948134095,0.971405611770073,0.971314700884800,0.971223209978993,0.971131133482950,0.971038465755410,0.970945201082408,0.970851333676094,0.970756857673538,0.970661767135505,0.970566056045215,0.970469718307065,0.970372747745341];
%beta=1, lamba = 1:0.25:4.5, c=1, Wm=Wl=0.5,  epsilon_ref = 0;k=1.109 N =
%10000;Expected
opt_eps_max2=[0.0143,0.0133,0.0125,0.0118,0.0113,0.0109 0.0105,0.0102,0.0099,0.0096,0.0094,0.0092,0.0090,0.0088,0.0086];
%beta=0.88, lamba = 1:0.25:2.25, c=1, Wm=Wl=0.5,  epsilon_ref = 0, k=1.5; N = 10000;
%opt_eps_max3=[0.0110,0.0102,0.0096,0.0091,0.0087,0.0083];
%beta=0.88, lamba = 1:0.25:45, c=1, Wm0.54, Wl=0.5,  epsilon_ref = 0, k=1.5; N = 10000;
opt_eps_max3=[0.0527,0.0409,0.0333,0.0279,0.0240,0.0210 0.0186,0.0167,0.0151,0.0138,0.0127,0.0117,0.0109,0.0102,0.0096];

lambda = 1:0.25:4.5;
plot(lambda,opt_eps_max1,'-r*',lambda,opt_eps_max2,'-bx',lambda,opt_eps_max3,'-ko','LineWidth',1.5);
%axis([1 2.25 0.008 0.015]);
set(gca,'XTick',1:0.5:2.25);
xlabel('\lambda');
ylabel('Opt \epsilon');


%%
%Ref

%beta=0.88, lamba = 1:0.25:2.25, c=1, Wm=Wl=0.5,  epsilon_ref = 0.005; N = 10000;
opt_eps_max3=[0.0117,0.0110,0.0104,0.0100,0.0096,0.0093];

%beta=0.88, lamba = 1:0.25:2.25, c=1, Wm=Wl=0.5,  epsilon_ref = 0.01; N = 10000;
opt_eps_max4=[0.0115,0.0112,0.0111,0.0110,0.0109,0.0108]

%beta=0.88, lamba = 1:0.25:2.25, c=1, Wm=Wl=0.5,  epsilon_ref = 0.04; N = 10000;
opt_eps_max5=[0.0130,0.0130,0.0130,0.0130,0.0130,0.0130]



%beta=0.88, lamba = 1:0.25:2.25, c=1, Wm=Wl=0.5,  epsilon_ref = 0.01; N = 2000;
opt_eps_max3=[0.0218,0.0204,0.0194,0.0186,0.0180,0.0174];

%%
%ref
%beta=0.88, lamba = 1:0.25:4.5, c=5, Wm=Wl=0.5,  epsilon_ref = 0; N = 10000;
opt_eps_max7 = [0.0070,0.0064,0.0060,0.0057,0.0054,0.0052 0.0050,0.0048,0.0047,0.0046,0.0044,0.0043,0.0042,0.0041,0.0040];
opt_Uc7 = [0.970736987215279,0.970492184811066,0.970258556681030,0.970033476315102,0.969815066670495,0.969602251338483,0.969393902252803,0.969189203512840,0.968988064656110,0.968789242424503,0.968593302508369,0.968399368308021,0.968207176834544,0.968016508056665,0.967827086498860]
Uc_byEUT = [0.970699955198772,0.970402109782584,0.970098143830525,0.969787866629652,0.969471079456391,0.969147575151254,0.968817137666157,0.968479541582256,0.968134551596031,0.967781921971162,0.967421395953487,0.967052705146137,0.966675568841612,0.966289693307328,0.965894771020782];
%beta=0.88, lamba = 1:0.25:2.25, c=5, Wm=Wl=0.5,  epsilon_ref = 0.005; N = 10000;
opt_eps_max8 = [0.0065,0.0063,0.0061,0.0060,0.0059,0.0058 0.0058,0.0057,0.0056,0.0056,0.0056,0.0055,0.0055,0.0055,0.0054];
%opt_Uc8 = [0.9708,0.9708,0.9708,0.9708,0.9707,0.9707];
%beta=0.88, lamba = 1:0.25:2.25, c=5, Wm=0.55 Wl=0.5,  epsilon_ref = 0.005;
%N = 10000; condition not hold
%opt_eps_max9 = [0.0106,0.0099,0.0094,0.0091,0.0088,0.0085];
%beta=0.88, lamba = 1:0.25:2.25, c=5, Wm=0.54 Wl=0.5,  epsilon_ref = 0.005; N = 10000;
%opt_eps_max10 = [0.0085,0.0082,0.0079,0.0077,0.0075,0.0074];
%opt_Uc10 = [0.9718,0.9718,0.9718,0.9718,0.9718,0.9718];
%beta=0.88, lamba = 1:0.25:4.5, c=5, Wm=0.5 Wl=0.5,  epsilon_ref = 0.04; N = 10000;
opt_eps_max11 = [0.0076,0.0076,0.0076,0.0076,0.0076,0.0076 0.0076,0.0076,0.0076,0.0076,0.0076,0.0076 0.0076,0.0076,0.0076];


%beta=1, lamba = 1:0.25:2.25, c=5, Wm=Wl=0.5,  epsilon_ref = 0; N =
%10000;Expected
%opt_eps_max12 = [0.0083,0.0077,0.0073,0.0069,0.0066,0.0063];
%opt_Uc12 = [0.9712,0.9711,0.9710,0.9708,0.9707,0.9706];

lambda = 1:0.25:2.25;
plot(lambda,opt_eps_max7(1:6),'-r*',lambda,opt_eps_max8(1:6),'-bx',lambda,opt_eps_max11(1:6),'-ko','LineWidth',1.5);
set(gca,'XTick',1:0.25:2.25);
legend('\epsilon_{ref}=0,W_m=0.5','\epsilon_{ref}=0.005,W_m=0.5','\epsilon_{ref}=0.04,W_m=0.5');
xlabel('\lambda');
ylabel('Opt \epsilon');

%%
%beta=0.88, lamba = 1:0.25:4.5, c=1, Wm=Wl=0.5,  epsilon_ref = 0, k=1.109; N = 1000;
opt_eps_max12=[0.0177,0.0164,0.0153,0.0145,0.0138,0.0132,0.0127,0.0122,0.0118,0.0115,0.0112,0.0109,0.0106,0.0103,0.0101];
%beta=1, lamba = 1:0.25:4.5, c=1, Wm=Wl=0.5,  epsilon_ref = 0;k=1.109 N =
%1000;Expected
opt_eps_max13=[0.0205,0.0189,0.0178,0.0169,0.0161,0.0155,0.0149,0.0144,0.0140,0.0136,0.0132,0.0129,0.0126,0.0123,0.0121]

%%
%beta=0.88, lamba = 1:0.25:2.25, c=1, Wm=Wl=0.5,  epsilon_ref = 0, k=1.109;N = 5000;
opt_eps_max1=[0.0158,0.0146,0.0137,0.0130,0.0124,0.0119,0.0115,0.0111,0.0108,0.0105,0.0102,0.0099,0.0097,0.0095,0.0093]
opt_Uc1=[0.944560313046033,0.944379807372990,0.944209095386110,0.944046011600290,0.943889084076508,0.943737287600872,0.943589843367042,0.943446171321747,0.943305764048331,0.943168290842731,0.943033448625727,0.942900870449131,0.942770510434607,0.942642049938459,0.942515344023795];
Uc_byEUT=[0.944541648215804,0.944329020414509,0.944114755116425,0.943898833322488,0.943681235738416,0.943461942768945,0.943240934511935,0.943018190752337,0.942793690956012,0.942567414263410,0.942339339483092,0.942109445085099,0.941877709194159,0.941644109582737,0.941408623663907];
%beta=1, lamba = 1:0.25:4.5, c=1, Wm=Wl=0.5,  epsilon_ref = 0;k=1.109 N =
%5000;Expected
opt_eps_max2=[0.0183,0.0170,0.0160,0.0152,0.0145,0.0139,0.0135,0.0130,0.0127,0.0123,0.0120,0.0117,0.0115,0.0112,0.0110]

%%
%n_target = 600; %data amount utility is 2/3 at this number
%k = 0.909;
%ProspectTheoryBased( lambda(i),0.88,0.88,5000,1,0,2,0,0.01:0.0001:0.02
%);lambda 1:0.5:3.5
Opt_epsilon_max_1=[0.0246,0.0213,0.0190,0.0176,0.0165,0.0155];
%ProspectTheoryBased( lambda(i),0.88,0.88,5000,1,0,2,0.01,0.01:0.0001:0.02
%);lambda 1:0.5:3.5
Opt_epsilon_max_2=[0.0233,0.0209,0.0192,0.0181,0.0171,0.0165];
%ProspectTheoryBased( lambda(i),0.88,0.88,5000,1,0,2,0.04,0.02:0.0001:0.04 );lambda 1:0.5:3.5
Opt_epsilon_max_3=[0.0251 0.0251 0.0251 0.0251 0.0251 0.0251];

%%
%n_target = 600; %data amount utility is 2/3 at this number
%k = 0.989;
%ProspectTheoryBased( lambda(i),0.88,0.88,5000,1,0,2,0,0.01:0.0001:0.02
%);lambda 1:0.5:3.5
Opt_epsilon_max_1=[0.0236,0.0207,0.0185,0.0170,0.0160,0.0151];
%ProspectTheoryBased( lambda(i),0.88,0.88,5000,1,0,2,0.01,0.01:0.0001:0.02
%);lambda 1:0.5:3.5
Opt_epsilon_max_2=[0.0224,0.0203,0.0188,0.0176,0.0167,0.0161];
%ProspectTheoryBased( lambda(i),0.88,0.88,5000,1,0,2,0.04,0.02:0.0001:0.04 );lambda 1:0.5:3.5
Opt_epsilon_max_3=[0.0243,0.0243,0.0243,0.0243,0.0243,0.0243];

%%
%approximation
%{
n_target = 600; %data amount utility is 2/3 at this number
k = 0.989;
l=(3*1.109-1)/n_target;

N=[5000 10000 20000 30000 40000 50000];
opt_eps_max_appro = zeros(1,length(N));
opt_eps_max = zeros(1,length(N));
for i=1:length(N)
    [ ~,opt_eps_max(i),~] = ProspectTheoryBased( 2.25,1,1,N(i),1,0.5,0.5,0,0.002:0.0001:0.04 );
    [ opt_eps_max_appro(i) ] = Approximation(  2.25,N(i),1,0.5,0.5 );
end
plot(N,opt_eps_max,'*',N,opt_eps_max_appro,'o');
dif = opt_eps_max-opt_eps_max_appro;
per = dif./opt_eps_max
%}


opt_eps_max =[ 0.0145    0.0113    0.0089      0.0070    0.0065];
opt_eps_max_appro =[0.0132    0.0105    0.0084    0.0066    0.0062];
per =[0.0871    0.0693    0.0613    0.0613    0.0521    0.0522];

%%
%EUT_cmp
%ProspectTheoryBased( lambda(i),0.88,0.88,5000,50,0,2,0,0.0068); 
%lambda =1:0.5:4.5
PT_opt_epsilon1=[0.0054    0.0045    0.0040    0.0036    0.0032    0.0030    0.0028    0.0026];
PT_opt_payoff1=[0.9425    0.9385    0.9344    0.9300    0.9254    0.9204    0.9150    0.9092];
U_mean1=[0.9420    0.9361    0.9281    0.9173    0.9019    0.8795    0.8446    0.7845];
diff1 =[0.0005    0.0024    0.0063    0.0127    0.0235    0.0409    0.0704    0.1247];
per1 =[0.0531    0.2557    0.6742    1.3656    2.5394    4.4437    7.6940   13.7154];
%%
%EUT_cmp
%ProspectTheoryBased( lambda(i),0.96,0.96,5000,50,0,2,0,0.0068); 
%lambda =1:0.5:4.5
PT_opt_epsilon3 =[ 0.0063    0.0054    0.0047    0.0043    0.0040    0.0037    0.0035    0.0033];
PT_opt_payoff3 =[ 0.9453    0.9429    0.9405    0.9381    0.9357    0.9331    0.9306    0.9279];
U_mean3 =[0.9453    0.9423    0.9388    0.9346    0.9294    0.9230    0.9153    0.9055];
diff3 =[0    0.0006    0.0017    0.0035    0.0063    0.0101    0.0153    0.0224]

per3 =[ 0    0.0636    0.1808    0.3731    0.6733    1.0824    1.6441    2.4141]


%%
%EUT_cmp
%ProspectTheoryBased( lambda(i),0.92,0.92,5000,50,0,2,0,0.0068); 
%lambda =1:0.5:4.5

PT_opt_epsilon2 =[0.0058    0.0049    0.0044    0.0039    0.0036    0.0034    0.0031    0.0029];
PT_opt_payoff2 =[0.9441    0.9410    0.9379    0.9347    0.9314    0.9279    0.9243    0.9204];
U_mean2 =[0.9439    0.9398    0.9346    0.9281    0.9196    0.9085    0.8936    0.8731];
diff2 =[0.0002    0.0012    0.0033    0.0066    0.0118    0.0194    0.0307    0.0473];
per2 =[ 0.0212    0.1275    0.3518    0.7061    1.2669    2.0907    3.3214    5.1391]

%%
%EUT_cmp
%ProspectTheoryBased( lambda(i),0.8,0.8,5000,50,0,2,0,0.0068); 
%lambda =1:0.5:4.5
PT_opt_epsilon2 =[0.0046    0.0037    0.0032    0.0028    0.0025    0.0023    0.0021    0.0019];
PT_opt_payoff2 =[0.9376    0.9304    0.9222    0.9130    0.9022    0.8898    0.8757    0.8594];
U_mean2 =       [0.9353    0.9212    0.8976    0.8537    0.7530    0.3375] 

%%
%EUT_cmp
%ProspectTheoryBased( lambda(i),1,1,5000,50,0,2,0,0.002:0.0001:0.02); 
%lambda =1:0.5:4.5
PT_opt_epsilon =[0.0068    0.0058    0.0052    0.0047    0.0044    0.0041    0.0039    0.0037];
PT_opt_payoff =[0.9463    0.9444    0.9425    0.9406    0.9388    0.9369    0.9350    0.9331];
%U_mean =       [0.9353    0.9212    0.8976    0.8537    0.7530    0.3375] 

